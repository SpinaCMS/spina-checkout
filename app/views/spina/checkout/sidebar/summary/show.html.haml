/ Subtotal
.sidebar-summary-line
  .pull-right= number_to_currency current_order.order_total_without_discount

  - if current_order.prices_include_tax?
    = Spina::Shop::Order.human_attribute_name(:sub_total)
  - else
    = Spina::Shop::Order.human_attribute_name(:sub_total_excl_tax)

/ Discount
- if current_order.discount.present?
  .sidebar-summary-line.text-success
    .pull-right= number_to_currency current_order.order_total - current_order.order_total_without_discount
    %span.text-success
      = current_order.discount.description
      = link_to sidebar_discount_path, class: 'button button-mini', data: {method: :delete, remote: true, action: 'sidebar-summary#fetchSummary'} do
        %i.icon.icon-bin

/ Delivery costs
- if current_order.delivery_option.present?
  .sidebar-summary-line
    .pull-right
      - if current_order.delivery_price.zero?
        %strong.text-success=t 'spina.checkout.free'
      - else
        = number_to_currency current_order.delivery_price
    = Spina::Shop::Order.human_attribute_name(:delivery_price)

/ Tax (only if order doesn't include tax)
- if !current_order.prices_include_tax?
  .sidebar-summary-line
    - if current_order.vat_reverse_charge?
      .pull-right=t 'spina.checkout.vat_reverse_charge'
      &nbsp;
    - else
      - current_order.tax_amount_by_rates.each do |rate, tax|
        .sidebar-summary-line
          .pull-right= number_to_currency tax[:tax_amount]
          =t 'spina.checkout.tax', rate: rate.round

/ Total
.sidebar-summary-line{class: ('sidebar-summary-line-big' unless current_order.gift_cards.any?)}
  .pull-right= number_to_currency current_order.total
  = Spina::Shop::Order.human_attribute_name(:total)

/ Gift cards
- if current_order.gift_cards.any?
  .sidebar-summary-line.text-success  
    .pull-right= number_to_currency current_order.gift_card_amount * -1
    %span.text-success=t 'spina.checkout.gift_card'

  .sidebar-summary-line.sidebar-summary-line-big
    .pull-right= number_to_currency current_order.to_be_paid
    =t 'spina.checkout.to_be_paid'

- if current_order.requires_shipping?
  / Delivery date if the order is shipped
  .sidebar-delivery
    .sidebar-summary-line{data: {controller: 'delivery-date', delivery_date_url: delivery_date_path}}
      .pull-right{data: {target: 'delivery-date.date'}}
      = Spina::Shop::Order.human_attribute_name(:expected_delivery)
